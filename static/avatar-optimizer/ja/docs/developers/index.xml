<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>開発者向け on Avatar Optimizer (1.9.3)</title><link>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/</link><description>Recent content in 開発者向け on Avatar Optimizer (1.9.3)</description><generator>Hugo</generator><language>ja</language><atom:link href="https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/index.xml" rel="self" type="application/rss+xml"/><item><title>システムの前提条件</title><link>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/system-assumptions/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/system-assumptions/</guid><description>&lt;h1 id="外部ツールに求める前提条件"&gt;
 外部ツールに求める前提条件
 &lt;a class="anchor" href="#%e5%a4%96%e9%83%a8%e3%83%84%e3%83%bc%e3%83%ab%e3%81%ab%e6%b1%82%e3%82%81%e3%82%8b%e5%89%8d%e6%8f%90%e6%9d%a1%e4%bb%b6"&gt;#&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;このページでは、Avatar Optimizerが外部ツールやデータ構造に対して仮定している条件について説明します。&lt;br&gt;
Avatar Optimizerと連携するツールを開発している場合は、これらの条件を尊重していただけると幸いです。&lt;/p&gt;
&lt;h2 id="transform-instance-usage"&gt;
 Transformインスタンスの使用方法
 &lt;a class="anchor" href="#transform-instance-usage"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Transformインスタンスが同一であるか否かは、Avatar Optimizer内で同じボーンであるか否かを判定するために使用されます。&lt;/p&gt;
&lt;p&gt;Avatar Optimizerは、Resolving Phaseで取得したTransform行列を使用し、Remove Mesh By Boxにより削除対象となる頂点を判断する場合があります。&lt;br&gt;
Transformを操作するツールを作成する場合は、Avatar Optimizerの最適化処理内において各Transformインスタンスが一貫して単一のボーンや目的を表すことを確認してください。&lt;/p&gt;
&lt;h2 id="vertex-index-usage"&gt;
 頂点インデックスの使用
 &lt;a class="anchor" href="#vertex-index-usage"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;ShaderInformationで明示的に登録されていない限り、頂点インデックスは、シェーダーやAvatar Optimizerの後に実行される他のプラグインなどにおいて使用されないものと仮定して扱われます。&lt;/p&gt;
&lt;p&gt;Avatar Optimizerは、その最適化処理においてメッシュを統合し、頂点インデックスを変更する可能性があります。&lt;br&gt;
シェーダーやツールで頂点インデックスを使用する場合は、&lt;a href="../shader-information"&gt;ShaderInformation API&lt;/a&gt;を介してその利用状況を登録し、不適切な最適化処理を防止する必要があります。&lt;/p&gt;
&lt;h2 id="external-parameter-usage"&gt;
 外部ツールによるAnimatorパラメーターの使用
 &lt;a class="anchor" href="#external-parameter-usage"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Avatar Optimizerは、Animatorパラメーターの使用方法やその値の範囲を用いて、不要なアニメーションなどを最適化することがあります。&lt;br&gt;
しかし、外部ツールによって使用されるパラメーターについては、アバターのデータから適切に推測することが不可能であるため、AssetDescriptionで明示的に宣言されていない限り、パラメーターは外部から使用されていないものと仮定して扱われます。&lt;/p&gt;
&lt;p&gt;ツールがOSCなどでパラメーターを変更したり読み取ったりする場合は、&lt;a href="../asset-description"&gt;AssetDescription&lt;/a&gt;を介して外部ツールから使用されるパラメーターとして登録してください。&lt;/p&gt;</description></item><item><title>Asset Description</title><link>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/asset-description/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/asset-description/</guid><description>&lt;h1 id="asset-description"&gt;
 Asset Description
 &lt;a class="anchor" href="#asset-description"&gt;#&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Asset DescriptionはAvatar Optimizerにアセットの情報を提供するためのファイルです。&lt;/p&gt;
&lt;h2 id="why-asset-description-is-needed"&gt;
 なぜAsset Descriptionが必要なのか
 &lt;a class="anchor" href="#why-asset-description-is-needed"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Avatar Optimizerは、Asset Descriptionで提供された情報を用いて最適化の失敗を防ぎます。&lt;/p&gt;
&lt;p&gt;Asset Descriptionでは、以下の情報を提供することができます。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Meaningless Components&lt;br&gt;
Avatar Optimizerに無視されるべきコンポーネントを指定します。&lt;/li&gt;
&lt;li&gt;Parameters Read By External Tools&lt;br&gt;
OSCツールなどの外部ツールから読み取られるパラメーターを指定します。&lt;/li&gt;
&lt;li&gt;Parameters Changed By External Tools&lt;br&gt;
OSCツールなどの外部ツールから変更されるパラメーターを指定します。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;各項目が必要な理由については以下の説明を参照してください。&lt;/p&gt;
&lt;h3 id="why-meaningless-components"&gt;
 Meaningless Components
 &lt;a class="anchor" href="#why-meaningless-components"&gt;#&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;アバター上の不要な要素を削除するために、Avatar Optimizerはアバターに存在するすべてのコンポーネントのことを知る必要があります。&lt;br&gt;
Avatar Optimizer v1.6.0で&lt;a href="../make-your-components-compatible-with-aao"&gt;コンポーネントにAAOとの互換性をもたせるためのドキュメント&lt;/a&gt;とAPIが追加されましたが、
非破壊ツールでなく、ビルド時に処理を行わないようなツールでは、&lt;code&gt;IVRCSDKPreprocessAvatarCallback&lt;/code&gt;でコンポーネントを削除するのは少し面倒だろうと考えました。&lt;br&gt;
そのため、Avatar Optimizerに無視してほしい、ビルド時やランタイムで処理を行わないコンポーネントを指定するためのシンプルな仕組みとして、Asset Descriptionがv1.7.0で追加されました。&lt;/p&gt;
&lt;p&gt;なお、非破壊ツールの場合については、正しくない実行順で処理が行われた場合にAvatar Optimizerがコンポーネントを誤って削除してしまわないように、従来通り&lt;code&gt;IVRCSDKPreprocessAvatarCallback&lt;/code&gt;やNDMFを使用してAvatar Optimizerの処理よりも先にコンポーネントを削除することを推奨します。&lt;/p&gt;
&lt;h3 id="why-parameters-read-by-external-tools"&gt;
 Parameters Read By Extenral Tools
 &lt;a class="anchor" href="#why-parameters-read-by-external-tools"&gt;#&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;PhysBoneやContact Receiverのようなコンポーネントは、OSCツールで読み取り可能なパラメーターを生成します。
そのようなパラメーターは、Animator ControllerやExpression Parameterに登録しなくても、OSCツールから読み取り可能であることが知られています。&lt;br&gt;
そのため、Avatar Optimizerはそれらのパラメーターが単に使用されていないものなのか、OSCツールで読み取るためのものなのかを判別することができません。
登録されていないパラメーターがOSCツールで使用されていることは比較的少ないため、コンポーネントが生成するパラメーターがアバター上で全く使われていない場合にはコンポーネントが削除されることになります。&lt;/p&gt;
&lt;p&gt;これを防ぐために、OSCツールから読み取られる目的のパラメーターをAsset Descriptionで指定することができます。&lt;/p&gt;
&lt;h3 id="why-parameters-written-by-external-tools"&gt;
 Parameters Changed By External Tools
 &lt;a class="anchor" href="#why-parameters-written-by-external-tools"&gt;#&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;この情報は現在のAvatar Optimizerでは使用されていませんが、将来的に使用することが計画されています。&lt;/p&gt;</description></item><item><title>Component Scripting API</title><link>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/component-api/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/component-api/</guid><description>&lt;h1 id="component-scripting-api"&gt;
 Component Scripting API
 &lt;a class="anchor" href="#component-scripting-api"&gt;#&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Avatar Optimizer v1.7.0以降、アバターにAvatar Optimizerのコンポーネントを追加・設定するためのComponent APIを提供しています。
このAPIを使用することで、Avatar Optimizerのコンポーネントを追加するツールやコンポーネントを作成することができます。&lt;/p&gt;
&lt;h2 id="supported-components"&gt;
 Component APIが利用可能なコンポーネント
 &lt;a class="anchor" href="#supported-components"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;現時点では、すべてのコンポーネントがComponent APIで利用出来るわけではありません。
Component APIが利用可能なコンポーネントの一覧は以下の通りです。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;RemoveMeshInBox&lt;/code&gt; - コンポーネントの追加と追加時の設定変更がサポートされています&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RemoveMeshByBlendShape&lt;/code&gt; - コンポーネントの追加と追加時の設定変更がサポートされています&lt;/li&gt;
&lt;li&gt;&lt;code&gt;RemoveMeshByMask&lt;/code&gt; - コンポーネントの追加と追加時の設定変更がサポートされています&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MergePhysBone&lt;/code&gt; - コンポーネントの追加と追加時の設定変更がサポートされています&lt;/li&gt;
&lt;li&gt;&lt;code&gt;TraceAndOptimize&lt;/code&gt; - デフォルト設定での追加はサポートされていますが、設定変更はサポートされていません&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;将来のバージョンで追加されるデフォルトで有効な機能との互換性を保つために、コンポーネントの設定変更を行う場合には注意が必要です。
詳細については以下のドキュメントを参照してください。&lt;/p&gt;
&lt;h2 id="getting-started"&gt;
 はじめに
 &lt;a class="anchor" href="#getting-started"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Component APIを使用するには、assembly definitionファイルで&lt;code&gt;com.anatawa12.avatar-optimizer.runtime&lt;/code&gt;を参照する必要があります。
Avatar Optimizerはランタイムで動作しないため、ランタイムビルド向けで&lt;code&gt;com.anatawa12.avatar-optimizer.runtime&lt;/code&gt;に依存してはいけません。&lt;br&gt;
&lt;code&gt;com.anatawa12.avatar-optimizer.runtime&lt;/code&gt;にあるいくつかのクラスは、将来のバージョンでランタイム向けビルドから除外される可能性があります。
言い換えると、ランタイム向けのアセンブリで&lt;code&gt;com.anatawa12.avatar-optimizer.runtime&lt;/code&gt;を使用するのは避けることをお勧めします。エディタ向けのアセンブリでのみ使用するようにしてください。&lt;/p&gt;
&lt;p&gt;次に、コンポーネントの設定を変更する場合は、将来のバージョンで追加される機能との互換性を確保するために&lt;code&gt;void Initialize(int version)&lt;/code&gt;メソッドを呼び出す必要があります。
(&lt;a href="../../basic-concept/#behavior-stability"&gt;動作の安定性&lt;/a&gt;で説明されているように、)デフォルト設定は変更される可能性があります。&lt;br&gt;
デフォルト設定は、&lt;code&gt;GameObject.AddComponent&amp;lt;T&amp;gt;()&lt;/code&gt;メソッドで追加されるコンポーネントに影響します。
従って、Avatar Optimizerの将来のバージョンとの互換性を保つためには、使用するデフォルト設定のバージョンを指定して&lt;code&gt;Initialize&lt;/code&gt;メソッドを呼び出す必要があります。
デフォルト設定のバージョンは、&lt;code&gt;Initialize&lt;/code&gt;メソッドのドキュメントに記載されているはずです。&lt;/p&gt;
&lt;blockquote class="book-hint warning"&gt;
&lt;p&gt;&lt;code&gt;Initialize&lt;/code&gt;メソッドを呼び出さなかった場合、コンポーネントが予期しない動作をしたり、将来的にエラーが発生したりする可能性があります。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote class="book-hint info"&gt;
&lt;p&gt;コンポーネントの設定変更はコンポーネントを追加した直後に行う場合のみサポートされており、既にGameObject上に存在しているコンポーネントに対する設定変更はサポートされていません。
これは、将来のバージョンで追加された機能が、既存のコンポーネントの設定内容と互換性がない可能性があるためです。&lt;/p&gt;
&lt;p&gt;例えば、v1.8.0で追加された&lt;code&gt;AAO Remove Mesh By Box&lt;/code&gt;コンポーネントの反転オプションを有効にすると、設定される箱による効果が変わってしまい、v1.7以前のみを想定して作成されているツールと互換性がなくなってしまいます。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;blockquote class="book-hint info"&gt;
&lt;p&gt;v1.9.0以降、&lt;code&gt;MergePhysBone&lt;/code&gt;コンポーネントのComponent APIを提供していますが、そのセマンティックバージョニング上の取り扱いは特殊なものになっています。&lt;/p&gt;
&lt;p&gt;このコンポーネントはVRChat SDKのPhysBoneコンポーネントと密接に結びついているため、PhysBoneコンポーネントの仕様変更に伴って、&lt;code&gt;MergePhysBone&lt;/code&gt;にも対応する変更が必要になる場合があります。
その場合、新しいプロパティの追加や既存プロパティの変更は、セマンティックバージョニングの規定に従わずに行われる可能性があります。&lt;/p&gt;</description></item><item><title>Shader Information API</title><link>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/shader-information/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/shader-information/</guid><description>&lt;h1 id="shader-information-api"&gt;
 Shader Information API
 &lt;a class="anchor" href="#shader-information-api"&gt;#&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Avatar Optimizer v1.8.0以降は、カスタムシェーダーを使用するマテリアルの最適化を支援するShader Information APIを提供しています。シェーダー情報を登録することで、Avatar Optimizerがテクスチャのアトラス化やUVのパッキングなどの高度な最適化を実行できるようになります。&lt;/p&gt;
&lt;h2 id="what-is-shader-information"&gt;
 Shader Informationとは？
 &lt;a class="anchor" href="#what-is-shader-information"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Shader Informationは、あなたのシェーダーがテクスチャ、UVチャンネル、その他のマテリアルプロパティをどのように使用しているかをAvatar Optimizerに伝える方法です。&lt;/p&gt;
&lt;p&gt;現在のAvatar Optimizerはこの情報を用いて、以下の方法でアバターを最適化します。将来的にさらに多くの最適化が追加される可能性があります。&lt;sup id="fnref:1"&gt;&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref"&gt;1&lt;/a&gt;&lt;/sup&gt; ただし、すべての最適化が Trace and Optimize によって自動的に実行されるわけではありません。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;複数のテクスチャをテクスチャアトラスにパッキング (&lt;code&gt;AAO Merge Material&lt;/code&gt;などのコンポーネントを使用)&lt;/li&gt;
&lt;li&gt;シェーダー機能で使用されているがマテリアル設定で無効化されているテクスチャを削除&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Shader Informationがない場合、Avatar Optimizerはシェーダーを保守的に扱い、これらの最適化の一部を実行できません。&lt;/p&gt;
&lt;h2 id="core-concepts"&gt;
 コアコンセプト
 &lt;a class="anchor" href="#core-concepts"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;h3 id="main-classes"&gt;
 主要なクラス
 &lt;a class="anchor" href="#main-classes"&gt;#&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Shader Information APIは3つの主要なクラスで構成されています:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;code&gt;ShaderInformation&lt;/code&gt;: シェーダーに関する情報を提供するために継承する基底クラス。&lt;code&gt;GetMaterialInformation&lt;/code&gt;をオーバーライドして、シェーダーを使用するマテリアルのテクスチャとUV使用状況を登録します。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;ShaderInformationRegistry&lt;/code&gt;: エディタ初期化中に&lt;code&gt;ShaderInformation&lt;/code&gt;実装をAvatar Optimizerに&lt;a href="#registration-methods"&gt;登録&lt;/a&gt;するために使用する静的クラス。&lt;/li&gt;
&lt;li&gt;&lt;code&gt;MaterialInformationCallback&lt;/code&gt;: &lt;code&gt;GetMaterialInformation&lt;/code&gt;に渡され、マテリアルプロパティを読み取り、テクスチャ/UV使用情報を登録するメソッドを提供します。&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id="null-values"&gt;
 Null値
 &lt;a class="anchor" href="#null-values"&gt;#&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;Shader Information API全体を通して、&lt;code&gt;null&lt;/code&gt;値には一貫した意味があります: &lt;strong&gt;不明な値&lt;/strong&gt;または&lt;strong&gt;アニメーション化された(静的に決定不可能な)値&lt;/strong&gt;を表します。マテリアルプロパティがアニメーション化されている可能性があるか、ビルド時にその値を決定できない場合、APIは不確実性を示すために&lt;code&gt;null&lt;/code&gt;を返します。値を静的に決定できない場合は、パラメータに&lt;code&gt;null&lt;/code&gt;を渡す必要があります。&lt;/p&gt;
&lt;h2 id="getting-started"&gt;
 はじめに
 &lt;a class="anchor" href="#getting-started"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;シェーダーのShader Informationを提供するには、以下の手順に従ってください:&lt;/p&gt;
&lt;h3 id="create-asmdef"&gt;
 1. Assembly Definitionを作成
 &lt;a class="anchor" href="#create-asmdef"&gt;#&lt;/a&gt;
&lt;/h3&gt;
&lt;p&gt;シェーダーパッケージにエディタ用のAssembly Definition（asmdef）がない場合は、作成してください。 Shader Informationはビルド時にのみ使用され、Shader Information APIはエディタでのみ利用可能なため、該当するアセンブリはエディタ専用にしてください。&lt;/p&gt;</description></item><item><title>アセットの配布について</title><link>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/distributing-prefabs/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/distributing-prefabs/</guid><description>&lt;h1 id="distributing-prefabs"&gt;
 アセットの配布について
 &lt;a class="anchor" href="#distributing-prefabs"&gt;#&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;Avatar Optimizerは配布したいアセットを軽量化したり最適化したりするのに役立つかもしれません。
Avatar Optimizerに依存するアセットを配布する際の推奨事項をいくつか示します。&lt;/p&gt;
&lt;h2 id="guide-to-the-official-distribution"&gt;
 ユーザーをAvatar Optimizer公式の配布場所に誘導する
 &lt;a class="anchor" href="#guide-to-the-official-distribution"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Avatar OptimizerはMITライセンスの下で公開されているため、再配布することが認められています。
それでも、Avatar Optimizer公式の配布場所にユーザーを誘導することを強くお勧めします。&lt;br&gt;
非公式に配布されるAvatar Optimizerはバージョンが古い可能性があります。
古いバージョンのAvatar Optimizerを使用していると、公式版では既に修正されているバグに遭遇するかもしれません。
また、Avatar Optimizerは前方互換性を保証していないため、新しいバージョンから古いバージョンにダウングレードさせてしまうと、そのユーザーの環境で何らかの問題が発生する可能性があります。&lt;/p&gt;
&lt;p&gt;ユーザーをAvatar Optimizer公式の配布場所に誘導する際に推奨される方法は以下の通りです。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;VPMでアセットを配布する場合は、Avatar OptimizerをVPMからインストールするように指示してください。&lt;br&gt;
VPMで配布するアセットの&lt;code&gt;package.json&lt;/code&gt;でAvatar Optimizerを依存関係として宣言し、
Avatar OptimizerのVPMリポジトリをALCOMまたはVCCに追加するようにユーザーを誘導してください。
&lt;a href="https://vpm.anatawa12.com/add-repo"&gt;こちら&lt;/a&gt;はAvatar Optimizerの公式リポジトリをALCOMまたはVCCに追加するためのリンクです。&lt;br&gt;
また、配布するアセットと同じVPMリポジトリに&lt;a href="https://vpm.anatawa12.com/vpm.json"&gt;Avatar Optimizerの公式リポジトリ&lt;/a&gt;をミラーしても構いません。
ミラーする場合は、GitHubのReleasesからミラーするのではなく、VPMリポジトリ自体をミラーしてください。&lt;/li&gt;
&lt;li&gt;Avatar Optimizerの公式ドキュメントへのリンクを提供してください。&lt;br&gt;
&lt;a href="https://vpm.anatawa12.com/avatar-optimizer/ja/#installation"&gt;こちら&lt;/a&gt;はAvatar Optimizer公式のインストールガイドです。
このガイドは、Avatar Optimizerを推奨される方法でインストールするようにユーザーを誘導します。&lt;/li&gt;
&lt;li&gt;&lt;a href="https://anatawa12.booth.pm/items/4885109"&gt;Avatar OptimizerのBoothページ&lt;/a&gt;へのリンクを提供してください。&lt;br&gt;
BoothページはAvatar Optimizer公式の配布場所の1つです。
Boothでは、最新バージョンのVPAIインストーラーunitypackageが含まれています。&lt;/li&gt;
&lt;li&gt;VPAIインストーラーunitypackageを同梱し、そのunitypackageをインポートするように指示してください。&lt;br&gt;
VPAIインストーラーは、Avatar OptimizerのようなVPMパッケージを、unitypackageをインポートするだけでインストールするためのツールです。
Avatar Optimizer 1.x.x用のVPAIインストーラーunitypackageをダウンロードするためのリンクは&lt;a href="https://api.anatawa12.com/create-vpai/?name=AvatarOptimizer-%7b%7d-installer.unitypackage&amp;amp;repo=https://vpm.anatawa12.com/vpm.json&amp;amp;package=com.anatawa12.avatar-optimizer&amp;amp;version=1.x.x"&gt;こちら&lt;/a&gt;です。&lt;/li&gt;
&lt;/ol&gt;</description></item><item><title>コンポーネントにAvatar Optimizerとの互換性をもたせる</title><link>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/make-your-components-compatible-with-aao/</link><pubDate>Mon, 01 Jan 0001 00:00:00 +0000</pubDate><guid>https://vpm.anatawa12.com/avatar-optimizer/ja/docs/developers/make-your-components-compatible-with-aao/</guid><description>&lt;h1 id="コンポーネントにavatar-optimizerとの互換性をもたせる"&gt;
 コンポーネントにAvatar Optimizerとの互換性をもたせる
 &lt;a class="anchor" href="#%e3%82%b3%e3%83%b3%e3%83%9d%e3%83%bc%e3%83%8d%e3%83%b3%e3%83%88%e3%81%abavatar-optimizer%e3%81%a8%e3%81%ae%e4%ba%92%e6%8f%9b%e6%80%a7%e3%82%92%e3%82%82%e3%81%9f%e3%81%9b%e3%82%8b"&gt;#&lt;/a&gt;
&lt;/h1&gt;
&lt;p&gt;このページでは以下の2つのことを説明します。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;コンポーネントはどのような場合にAvatar Optimizerと非互換になるか&lt;/li&gt;
&lt;li&gt;どのように互換性を改善するか&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;もし質問があれば、お気軽に&lt;a href="https://misskey.niri.la/@anatawa12"&gt;Fediverse (Misskey / Mastodon)&lt;/a&gt;や&lt;a href="https://discord.gg/dV4cVpewmM"&gt;NDMF Discord&lt;/a&gt;でご連絡ください。&lt;/p&gt;
&lt;h2 id="when-incompatible"&gt;
 コンポーネントはどのような場合にAvatar Optimizerと非互換になるか
 &lt;a class="anchor" href="#when-incompatible"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;Avatar Optimizerが処理する時点でアバターにコンポーネントが存在している場合、そのコンポーネントはAvatar Optimizerと互換性が無い可能性があります。&lt;/p&gt;
&lt;p&gt;Avatar Optimizerはビルド処理の最後の方で動作するように設計されているため、Avatar Optimizerにとって未知のコンポーネントについてはサポートしていません。&lt;/p&gt;
&lt;p&gt;例えば、Avatar Optimizerはコンポーネント等に対するガベージコレクションシステムを実装しています。
使用されているコンポーネントを保持し、未使用のコンポーネントを適切に削除するためには、
最適化時にアバターに存在するすべてのコンポーネントのことを知っておく必要があります。&lt;/p&gt;
&lt;p&gt;未知のコンポーネントによる問題を避けるため、Avatar Optimizerは未知のコンポーネントが以下のようなものであると仮定します。&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;コンポーネントが有効かつアクティブになる可能性がある場合は保持される必要がある。
&lt;ul&gt;
&lt;li&gt;これは、未知のコンポーネントが実行時(VRChat上など)に動作するコンポーネントであると仮定しているためです。&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;コンポーネントが参照している全てのコンポーネントに依存している。&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;(上記の仮定は将来的に変更される可能性があります。)&lt;/p&gt;
&lt;p&gt;しかしながら、これらの仮定は正しくない可能性があるため、Avatar Optimizerは以下のような警告を生成します。&lt;/p&gt;
&lt;p&gt;&lt;img src="https://vpm.anatawa12.com/avatar-optimizer/en/docs/developers/make-your-components-compatible-with-aao/unknown-component-warning.png" alt="unknown-component-warning" /&gt;&lt;/p&gt;
&lt;h2 id="improve-compatibility"&gt;
 どのように互換性を改善するか
 &lt;a class="anchor" href="#improve-compatibility"&gt;#&lt;/a&gt;
&lt;/h2&gt;
&lt;p&gt;以下の対応のいずれかを行うことで、互換性を改善することができます。&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;Avatar Optimizerが処理する前にコンポーネントを削除する&lt;/p&gt;
&lt;p&gt;コンポーネントが実行時では動作しないものである場合、(すなわち、ビルド時や編集モードでのみ動作するコンポーネントである場合、)
Avatar Optimizerより前にアバターを処理し、コンポーネントを削除することが殆どの場合で最善です。&lt;/p&gt;
&lt;p&gt;詳細は&lt;a href="#remove-component"&gt;下のセクション&lt;/a&gt;を参照してください。&lt;/p&gt;
&lt;p&gt;Avatar Optimizerは、Trace and Optimizeの前に処理を行う殆どのAvatar Optimizerコンポーネントにおいて、内部的にこの方法を使用しています。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;APIを使用してAvatar Optimizerにコンポーネントを登録する&lt;/p&gt;
&lt;p&gt;実行時に動作するコンポーネントや、Avatar Optimizerより後にアバターを処理するために残しておく必要があるコンポーネントの場合、
そのコンポーネントの情報をAvatar Optimizerに登録することができます。&lt;/p&gt;
&lt;p&gt;詳細は&lt;a href="#register-component"&gt;下のセクション&lt;/a&gt;を参照してください。&lt;/p&gt;
&lt;p&gt;Avatar Optimizerは、Trace and Optimizeの後に処理を行う一部のコンポーネントや、Unity純正のコンポーネント、VRCSDKのコンポーネントなどを保持するために、内部的にこの方法を使用しています。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Asset Descriptionを使用して、削除しても問題のないコンポーネントとしてAvatar Optimizerに登録する&lt;/p&gt;
&lt;p&gt;Avatar Optimizer v1.7.0以降では、実行時やビルド時で処理を行わないコンポーネント向けに&lt;a href="../asset-description"&gt;Asset Description&lt;/a&gt;が追加されています。
ツールが実行時やビルド時に何も行わない場合は、「Avatar Optimizerが処理する前にコンポーネントを削除する」代わりにこの方法を使用してコンポーネントを登録することができます。&lt;/p&gt;</description></item></channel></rss>